<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi">
    <title>Trader Calculator</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body class="pywebview-drag-region">
    <div class="m-4">
      <nav aria-label="Page navigation example">
        <ul class="pagination">
          <li class="page-item" ><p style="margin-bottom: -0.6rem;"><img src="icon.png" alt="" height="60px" width="60px"> Trader Calculator |<cite class="text-muted"> <small>Version: 1.0</small></cite></p></li>
          <li class="page-item" style="padding-left: 83px;"><a class="page-link btn-sys" onclick="pywebview.api.minimizePage()"><i class="fa fa-window-minimize" aria-hidden="true"></i></a></li>
          <!-- <li class="page-item"><a class="page-link btn-sys" href="#"><i class="fa fa-question" aria-hidden="true"></i></a></li> -->
          <li class="page-item"><a class="page-link btn-sys" onclick="pywebview.api.closePage()"><i class="fa fa-times" aria-hidden="true"></i></a></li>
        </ul>
      </nav>
      <div class=" nav btn-group" role="group" id="myTab">
        <a href="#futures" class="btn btn-outline-primary btn-sm active"  draggable="false" data-bs-toggle="tab" style="border-bottom-left-radius: 0rem !important;">Futures</a>
        <a href="#spot" class="btn btn-outline-primary btn-sm noshad"  draggable="false" data-bs-toggle="tab">Spot</a>
        <a href="#dca" class="btn btn-outline-primary btn-sm noshad"  draggable="false" data-bs-toggle="tab" style="border-bottom-right-radius: 0rem !important;">DCA</a>
      </div>
      <div class="tab-content">
        <!-- Futures Panel-->
        <div class="tab-pane fade show active" id="futures">
          <div class="row">
            <div class="col-12">
              <form class="former" id="futureForm">
                <div class="row">
                  <div class="col-4 text-center">
                    <label for="" class="form-label texter">Wallet</label>
                    <div class="input-group">
                      <input type="number" class="form-control form-control-sm" id="allWallet">
                    </div>
                  </div>
                  <div class="col-4 text-center" style="height: 5px;">
                    <p class="texter" style="margin-bottom: 0.7rem !important;">% Wallet</p>
                    <p class="text-info" id="percWallet" style="margin-bottom: 0rem !important;">-</p>
                  </div>
                  <div class="col-4 text-center">
                    <label for="" class="form-label text-center texter">Position Size</label>
                    <div class="input-group">
                      <input type="number" class="form-control form-control-sm" id="positionSize" required>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row">
                  <div class="form-group col-6">
                    <select class="form-select form-control-sm" id="sidePosition">
                      <option value="long">Long</option>
                      <option value="short">Short</option>
                    </select>
                  </div> 
                  <div class="form-group col-6">
                    <select class="form-select form-control-sm" id="leverage">
                      <option value="1">x1</option>
                      <option value="2">x2</option>
                      <option value="3">x3</option>
                      <option value="4">x4</option>
                      <option value="5">x5</option>
                      <option value="6">x6</option>
                      <option value="7">x7</option>
                      <option value="8">x8</option>
                      <option value="9">x9</option>
                      <option value="10">x10</option>
                      <option value="11">x11</option>
                      <option value="12">x12</option>
                      <option value="13">x13</option>
                      <option value="14">x14</option>
                      <option value="15">x15</option>
                      <option value="16">x16</option>
                      <option value="17">x17</option>
                      <option value="18">x18</option>
                      <option value="19">x19</option>
                      <option value="20">x20</option>
                      <option value="21">x21</option>
                      <option value="22">x22</option>
                      <option value="23">x23</option>
                      <option value="24">x24</option>
                      <option value="25">x25</option>
                      <option value="26">x26</option>
                      <option value="27">x27</option>
                      <option value="28">x28</option>
                      <option value="29">x29</option>
                      <option value="30">x30</option>
                      <option value="31">x31</option>
                      <option value="32">x32</option>
                      <option value="33">x33</option>
                      <option value="34">x34</option>
                      <option value="35">x35</option>
                      <option value="36">x36</option>
                      <option value="37">x37</option>
                      <option value="38">x38</option>
                      <option value="39">x39</option>
                      <option value="40">x40</option>
                      <option value="41">x41</option>
                      <option value="42">x42</option>
                      <option value="43">x43</option>
                      <option value="44">x44</option>
                      <option value="45">x45</option>
                      <option value="46">x46</option>
                      <option value="47">x47</option>
                      <option value="48">x48</option>
                      <option value="49">x49</option>
                      <option value="50">x50</option>
                      <option value="51">x51</option>
                      <option value="52">x52</option>
                      <option value="53">x53</option>
                      <option value="54">x54</option>
                      <option value="55">x55</option>
                      <option value="56">x56</option>
                      <option value="57">x57</option>
                      <option value="58">x58</option>
                      <option value="59">x59</option>
                      <option value="60">x60</option>
                      <option value="61">x61</option>
                      <option value="62">x62</option>
                      <option value="63">x63</option>
                      <option value="64">x64</option>
                      <option value="65">x65</option>
                      <option value="66">x66</option>
                      <option value="67">x67</option>
                      <option value="68">x68</option>
                      <option value="69">x69</option>
                      <option value="70">x70</option>
                      <option value="71">x71</option>
                      <option value="72">x72</option>
                      <option value="73">x73</option>
                      <option value="74">x74</option>
                      <option value="75">x75</option>
                      <option value="76">x76</option>
                      <option value="77">x77</option>
                      <option value="78">x78</option>
                      <option value="79">x79</option>
                      <option value="80">x80</option>
                      <option value="81">x81</option>
                      <option value="82">x82</option>
                      <option value="83">x83</option>
                      <option value="84">x84</option>
                      <option value="85">x85</option>
                      <option value="86">x86</option>
                      <option value="87">x87</option>
                      <option value="88">x88</option>
                      <option value="89">x89</option>
                      <option value="90">x90</option>
                      <option value="91">x91</option>
                      <option value="92">x92</option>
                      <option value="93">x93</option>
                      <option value="94">x94</option>
                      <option value="95">x95</option>
                      <option value="96">x96</option>
                      <option value="97">x97</option>
                      <option value="98">x98</option>
                      <option value="99">x99</option>
                      <option value="100">x100</option>       
                    </select>
                  </div>
                </div>
                <br>
                <div class="row form-group text-center">
                  <div class="col-4">
                    <label class="texter">Entry Price</label>
                    <input type="number" class="form-control  form-control-sm" placeholder="" id="entry" required>
                  </div>
                  <div class="col-4">
                    <label class="texter">Take Profit</label>
                    <input type="number" class="form-control  form-control-sm" id="takeprofit" placeholder="">
                  </div>
                  <div class="col-4">
                    <label class="texter">Stop Loss</label>
                    <input type="number" class="form-control form-control-sm" id="stoploss" placeholder="">
                  </div>
                </div>
                <div class="row texter text-center" style="height: 40px; padding-top: 10px;">
                  <div class="col-4">
                    <p>Estimated Loss:<br><b><span class="text-danger" id="dollarLose">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p>Estimated Profit:<br><b><span class="text-success" id="dollarGain">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p>Risk/Reward:<br> <span class="text-info" id="rrr">-</span></p>
                  </div>
                </div>
                <div class="row texter text-center" style="height: 40px; padding-top: 10px;">
                  <div class="col-4">
                    <p><b><span class="text-danger" id="percLoss">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p><b><span class="text-success" id="percProfit">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p class="text-info" id="sidetxt">-</p>
                  </div>
                </div>
                <hr class="hrer">
                <div class="btn-group col-12" role="group">
                  <button type="reset" class="btn btn-short noshad">Reset Values</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <!-- End Futures Panel-->
        <!-- Spot Panel-->
        <div class="tab-pane fade" id="spot">
          <div class="row">
            <div class="col-12">
              <form class="former" id="futureForm">
                <div class="row" style="padding-top: 25px;">
                  <div class="col-4 text-center">
                    <label for="" class="form-label texter">Wallet</label>
                    <div class="input-group">
                      <input type="number" class="form-control" id="allWalletSpot">
                    </div>
                  </div>
                  <div class="col-4 text-center" style="height: 5px;">
                    <p class="texter" style="margin-bottom: 0.7rem !important;">% Wallet</p>
                    <p class="text-info" id="percWalletSpot" style="margin-bottom: 0rem !important; padding-top: 4px;">-</p>
                  </div>
                  <div class="col-4 text-center">
                    <label for="" class="form-label text-center texter">Position Size</label>
                    <div class="input-group">
                      <input type="number" class="form-control" id="positionSizeSpot" required>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row form-group text-center">
                  <div class="col-4">
                    <label class="texter">Entry Price</label>
                    <input type="number" class="form-control" placeholder="" id="entrySpot" required>
                  </div>
                  <div class="col-4">
                    <label class="texter">Take Profit</label>
                    <input type="number" class="form-control" id="takeprofitSpot" placeholder="">
                  </div>
                  <div class="col-4">
                    <label class="texter">Stop Loss</label>
                    <input type="number" class="form-control" id="stoplossSpot" placeholder="">
                  </div>
                </div>
                <div class="row texter text-center" style="height: 40px; padding-top: 10px;">
                  <div class="col-4">
                    <p>Estimated Loss:<br><b><span class="text-danger" id="dollarLoseSpot">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p>Estimated Profit:<br><b><span class="text-success" id="dollarGainSpot">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p>Risk/Reward:<br><b><span class="text-info" id="rrrSpot">-</span></b></p>
                  </div>
                </div>
                <div class="row texter text-center" style="height: 40px; padding-top: 10px;">
                  <div class="col-4">
                    <p><b><span class="text-danger texter" id="percLossSpot">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p><b><span class="text-success texter" id="percProfitSpot">-</b></span></p>
                  </div>
                  <div class="col-4">
                  </div>
                </div>
                <hr class="hrer" style="margin-top: 20px;">
                <div class="btn-group col-12" role="group">
                  <button type="reset" class="btn btn-short noshad">Reset Values</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <!-- End Spot Panel-->
        <!-- DCA Panel-->
        <div class="tab-pane fade" id="dca">
          <div class="row">
            <div class="col-12">
              <form class="former" id="DCAForm" style="line-height: 1.2em !important;">
                <div class="row form-group text-center">
                  <div class="col-1" style="padding-top: 25px;">
                    <label class="texter text-muted">#1</label>
                  </div>
                  <div class="col-4">
                    <label class="texter">Capital Invested</label>
                    <input type="number" class="form-control form-control-sm" placeholder="" id="entryDCA1" required>
                  </div>
                  <div class="col-4">
                    <label class="texter">Price Bought</label>
                    <input type="number" class="form-control form-control-sm" id="priceDCA1" placeholder="">
                  </div>
                  <div class="col-3">
                    <label class="texter">Quantity</label>
                    <p><b><span class="text-info texter" id="qtDCA1">-</b></span></p>
                  </div>
                </div>
                <div class="row form-group text-center">
                  <div class="col-1" style="padding-top: 25px;">
                    <label class="texter text-muted">#2</label>
                  </div>
                  <div class="col-4">
                    <label class="texter">Capital Invested</label>
                    <input type="number" class="form-control form-control-sm" placeholder="" id="entryDCA2" required>
                  </div>
                  <div class="col-4">
                    <label class="texter">Price Bought</label>
                    <input type="number" class="form-control form-control-sm" id="priceDCA2" placeholder="">
                  </div>
                  <div class="col-3">
                    <label class="texter">Quantity</label>
                    <p><b><span class="text-info texter" id="qtDCA2">-</b></span></p>
                  </div>
                </div>
                <div class="row form-group text-center">
                  <div class="col-1" style="padding-top: 25px;">
                    <label class="texter text-muted">#3</label>
                  </div>
                  <div class="col-4">
                    <label class="texter">Capital Invested</label>
                    <input type="number" class="form-control form-control-sm" placeholder="" id="entryDCA3" required>
                  </div>
                  <div class="col-4">
                    <label class="texter">Price Bought</label>
                    <input type="number" class="form-control form-control-sm" id="priceDCA3" placeholder="">
                  </div>
                  <div class="col-3">
                    <label class="texter">Quantity</label>
                    <p><b><span class="text-info texter" id="qtDCA3">-</b></span></p>
                  </div>
                </div>
                <div class="row form-group text-center">
                  <div class="col-1" style="padding-top: 25px;">
                    <label class="texter text-muted">#4</label>
                  </div>
                  <div class="col-4">
                    <label class="texter">Capital Invested</label>
                    <input type="number" class="form-control form-control-sm" placeholder="" id="entryDCA4" required>
                  </div>
                  <div class="col-4">
                    <label class="texter">Price Bought</label>
                    <input type="number" class="form-control form-control-sm" id="priceDCA4" placeholder="">
                  </div>
                  <div class="col-3">
                    <label class="texter">Quantity</label>
                    <p><b><span class="text-info texter" id="qtDCA4">-</b></span></p>
                  </div>
                </div>
                <div class="row texter text-center" style="height: 40px; padding-top: 5px;">
                  <div class="col-4">
                    <p>Total Capital<br><b><span class="text-primary" id="capitalDCA">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p>Dollar Cost Avg.<br><b><span class="text-success" id="DCA">-</b></span></p>
                  </div>
                  <div class="col-4">
                    <p>Total Quantity<br><b><span class="text-info" id="quantityDCA">-</span></b></p>
                  </div>
                </div>
                <hr class="hrer">
                <div class="btn-group col-12" role="group">
                  <button type="reset" class="btn btn-short noshad">Reset Values</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <!-- End DCA Panel-->
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.1.slim.min.js" integrity="sha256-w8CvhFs7iHNVUtnSP0YKEg00p9Ih13rlL9zGqvLdePA=" crossorigin="anonymous"></script>
    <script>
      $('input').keyup(function(){ // run anytime the value changes
        // Capitalize Letter
        function capitalize(s) {
          return s && s[0].toUpperCase() + s.slice(1);
        }
        
        var firstValue  = Number($('#allWallet').val());   // get value of field
        var secondValue = Number($('#positionSize').val()); // convert it to a float
        var percWallet  = ((secondValue * 100) / firstValue).toFixed(2);
        var sideValue   = String($('#sidePosition').val());
        var leveValue   = Number($('#leverage').val());
        var entryValue  = Number($('#entry').val());
        var takeValue   = Number($('#takeprofit').val());
        var stopValue   = Number($('#stoploss').val());
        var percentagePos = 0
        var ProfitPos     = 0

        /*SPOT*/

        var firstValueSpot  = Number($('#allWalletSpot').val());   // get value of field
        var secondValueSpot = Number($('#positionSizeSpot').val()); // convert it to a float
        var percWalletSpot  = ((secondValueSpot * 100) / firstValueSpot).toFixed(2);
        var entryValueSpot  = Number($('#entrySpot').val());
        var takeValueSpot   = Number($('#takeprofitSpot').val());
        var stopValueSpot   = Number($('#stoplossSpot').val());
        var percentagePosSpot = 0
        var ProfitPosSpot     = 0

        /*DCA*/

        var entry1 = Number($('#entryDCA1').val());
        var price1 = Number($('#priceDCA1').val()); 
        var entry2 = Number($('#entryDCA2').val());
        var price2 = Number($('#priceDCA2').val()); 
        var entry3 = Number($('#entryDCA3').val());
        var price3 = Number($('#priceDCA3').val());
        var entry4 = Number($('#entryDCA4').val());
        var price4 = Number($('#priceDCA4').val());


        if (sideValue == "short") {
          percentageProfit = (((((takeValue - entryValue) / entryValue) * 100) * leveValue ) * -1).toFixed(2)
          percentageLoss   = (((((stopValue - entryValue) / entryValue) * 100) * leveValue ) * -1).toFixed(2)
        } else {
          percentageProfit = ((((takeValue - entryValue) / entryValue) * 100) * leveValue).toFixed(2)
          percentageLoss   = ((((stopValue - entryValue) / entryValue) * 100) * leveValue ).toFixed(2)
        }

        if ((entryValue < takeValue) && (sideValue == "long")) {
          sideValue == "Error";
        }
        if ((entryValue > takeValue) && (sideValue == "short")) {
          sideValue == "Error"
        }
        var dollarPro   =  ((secondValue * percentageProfit) / 100).toFixed(2)
        var dollarLos   =  ((secondValue * percentageLoss) /100).toFixed(2)
        var riskReward  = (((percentageProfit / percentageLoss) / leveValue)*10).toFixed(2) 
         
        $('#percWallet').html(getNum(percWallet)+' %'); // add them and output it
        $('#percProfit').html(getNum(percentageProfit)+' %');
        $('#percLoss').html(getNum(percentageLoss)+' %');
        $('#dollarGain').html(getNum(dollarPro)+' $');
        $('#dollarLose').html(getNum(dollarLos)+' $');
        $('#sidetxt').html(capitalize(sideValue) + " | x" + leveValue);
        $('#rrr').html(Math.abs(getNum(riskReward)));


        /* SPOT */
        percentageProfitSpot = ((((takeValueSpot - entryValueSpot) / entryValueSpot) * 100)).toFixed(2)
        percentageLossSpot   = ((((stopValueSpot - entryValueSpot) / entryValueSpot) * 100)).toFixed(2)
        var dollarProSpot    =  ((secondValueSpot * percentageProfitSpot) / 100).toFixed(2)
        var dollarLosSpot    =  ((secondValueSpot * percentageLossSpot) /100).toFixed(2)
        var riskRewardSpot   = (((percentageProfitSpot / percentageLossSpot))*10).toFixed(2) 
        $('#percWalletSpot').html(getNum(percWalletSpot)+' %'); // add them and output it
        $('#percProfitSpot').html(getNum(percentageProfitSpot)+' %');
        $('#percLossSpot').html(getNum(percentageLossSpot)+' %');
        $('#dollarGainSpot').html(getNum(dollarProSpot)+' $');
        $('#dollarLoseSpot').html(getNum(dollarLosSpot)+' $');
        $('#rrrSpot').html(Math.abs(getNum(riskRewardSpot)));

        /*DCA*/
        var qt1    = (entry1/price1).toFixed(4)
        var qt2    = (entry2/price2).toFixed(4)
        var qt3    = (entry3/price3).toFixed(4)
        var qt4    = (entry4/price4).toFixed(4)
        var totQt  = parseFloat(getNum(qt1)) + parseFloat(getNum(qt2)) + parseFloat(getNum(qt3)) + parseFloat(getNum(qt4))
        var totCap = entry1 + entry2 + entry3 + entry4
        var dca    = totCap/totQt
        dca = getNum(dca)
        dca = dca.toFixed(4)

        $('#qtDCA1').html(getNum(qt1));
        $('#qtDCA2').html(getNum(qt2));
        $('#qtDCA3').html(getNum(qt3));
        $('#qtDCA4').html(getNum(qt4));
        $('#quantityDCA').html(totQt.toFixed(4));
        $('#capitalDCA').html(totCap.toFixed(2) + " $");
        $('#DCA').html(dca+ " $");

      });
      
      // Block zoom with wheel
      (function () {
        let SSWZ = function () {
          /**
           * * Handler for scroll- control must be pressed.
           * * @param e
          * */
         this.keyScrollHandler = function (e) {
          if (e.ctrlKey) {
            e.preventDefault();
            return false;
          }
        }
      };
      
      if (window === top) {
        let sswz = new SSWZ();
        window.addEventListener('wheel', sswz.keyScrollHandler, { passive: false });
      }
    })();

    // Block CTRL + U
    document.onkeydown = function(e) {
      if (e.ctrlKey && 
      (e.keyCode === 67 || e.keyCode === 86 || e.keyCode === 85 || e.keyCode === 117)) {
        return false;
      } else {
        return true;
      }
    };

    function getNum(val) {
      if (isNaN(val)) {
        return 0;
      }
      return val;
    }
    
    </script>
  </body>
</html>
